name: Integrated Deployment Pipeline

on:
  push:
    branches: ['**']
    paths:
      - 'src/**'
      - 'infrastructure/**'
      - 'Dockerfile'
      - 'package.json'
      - 'bun.lock'
      - 'tsconfig.json'
      - '.github/workflows/deploy-integrated.yml'
  workflow_dispatch:

permissions:
  contents: read
  id-token: write

env:
  ENABLE_INTEGRATED_DEPLOY: false
  ENABLE_PRODUCTION_DEPLOY: false
  
  REGION: asia-northeast1
  TF_CLOUD_ORGANIZATION: "fact-checker"  # Terraform Cloudçµ„ç¹”å
  
  # ãƒ™ãƒ¼ã‚¹åç§°
  APP_NAME_BASE: "x-fact-checker"
  WORKSPACE_BASE: "fact-checker"
  ARTIFACT_REPO_BASE: "fact-checker-repo"

jobs:
  # Phase 1: åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£
  infrastructure-base:
    runs-on: ubuntu-latest
    outputs:
      environment: ${{ steps.env.outputs.environment }}
      branch_name: ${{ steps.env.outputs.branch_name }}
      workspace_name: ${{ steps.env.outputs.workspace_name }}
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Set Environment Variables
        id: env
        run: |
          # ç’°å¢ƒåˆ¤å®š
          ENVIRONMENT=$([ "${{ github.ref }}" = "refs/heads/main" ] && echo "production" || echo "staging")
          
          # ENVä½¿ã£ã¦å„ç¨®åç§°ç”Ÿæˆ
          APP_NAME="${{ env.APP_NAME_BASE }}-$ENVIRONMENT"
          # TODO: terraform cloudã®å®Ÿè¨¼ç¢ºèªã®ãŸã‚ã€ä¸€æ—¦fs workspaceã«ãŠã„ã¦ä½œæ¥­ä¸­ã€‚ç¢ºèªãŒçµ‚ã‚ã£ãŸã‚‰stagingã«æˆ»ã™ã“ã¨
          WORKSPACE_SUFFIX=$([ "$ENVIRONMENT" = "production" ] && echo "production" || echo "fs")
          WORKSPACE_NAME="${TF_WORKSPACE:-${{ env.WORKSPACE_BASE }}-$WORKSPACE_SUFFIX}"
          
          # GitHub Outputã«è¨­å®š
          echo "environment=$ENVIRONMENT" >> $GITHUB_OUTPUT
          echo "branch_name=${{ github.ref_name }}" >> $GITHUB_OUTPUT
          echo "app_name=$APP_NAME" >> $GITHUB_OUTPUT
          echo "workspace_name=$WORKSPACE_NAME" >> $GITHUB_OUTPUT
          
          echo "=== Phase 1: åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ© ==="
          echo "Branch: ${{ github.ref_name }}"
          echo "Environment: $ENVIRONMENT"
          echo "App Name: $APP_NAME"
          echo "Workspace: $WORKSPACE_NAME"
      
      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: 1.6.6
          cli_config_credentials_token: ${{ secrets.TF_API_TOKEN }}
      
      - name: Terraform Init
        working-directory: ./infrastructure
        env:
          TF_WORKSPACE: ${{ steps.env.outputs.workspace_name }}
        run: terraform init
      
      - name: Terraform Validate
        working-directory: ./infrastructure
        env:
          TF_WORKSPACE: ${{ steps.env.outputs.workspace_name }}
        run: |
          echo "ğŸ” åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©Terraformæ§‹æ–‡ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ"
          terraform validate
          echo "âœ… åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©Terraformæ§‹æ–‡ãƒã‚§ãƒƒã‚¯æˆåŠŸ"
      
      - name: Terraform Plan (Base Infrastructure)
        working-directory: ./infrastructure
        env:
          TF_WORKSPACE: ${{ steps.env.outputs.workspace_name }}
        run: |
          echo "ğŸ” åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©Terraform Planå®Ÿè¡Œï¼ˆTerraform Cloud ãƒªãƒ¢ãƒ¼ãƒˆï¼‰"
          terraform plan -var="deploy_phase=base" -var="branch_name=${{ steps.env.outputs.branch_name }}" -var="gcp_project_id=${{ secrets.PROJECT_ID }}"
          echo "âœ… åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©Terraform PlanæˆåŠŸ"

  # Phase 1 Apply: åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©ä½œæˆ
  infrastructure-apply:
    needs: infrastructure-base
    runs-on: ubuntu-latest
    if: vars.ENABLE_INTEGRATED_DEPLOY == 'true'
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Authenticate to Google Cloud
        uses: google-github-actions/auth@v2
        with:
          credentials_json: ${{ secrets.GCLOUD_SERVICE_KEY }}
          project_id: ${{ secrets.PROJECT_ID }}
      
      - name: Setup Google Cloud SDK
        uses: google-github-actions/setup-gcloud@v2
      
      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: 1.6.6
          cli_config_credentials_token: ${{ secrets.TF_API_TOKEN }}
      
      - name: Terraform Init (Base Infrastructure Apply)
        working-directory: ./infrastructure
        env:
          TF_WORKSPACE: ${{ needs.infrastructure-base.outputs.workspace_name }}
        run: |
          echo "ğŸš€ åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©TerraformåˆæœŸåŒ–ä¸­..."
          terraform init
          echo "âœ… åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©TerraformåˆæœŸåŒ–å®Œäº†"
      
      - name: Terraform Plan (triggers Terraform Cloud for Base)
        working-directory: ./infrastructure
        env:
          TF_WORKSPACE: ${{ needs.infrastructure-base.outputs.workspace_name }}
        run: |
          echo "ğŸš€ åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©Terraform Planå®Ÿè¡Œã§Terraform Cloudï¼ˆãƒªãƒ¢ãƒ¼ãƒˆï¼‰ã‚’ãƒˆãƒªã‚¬ãƒ¼"
          terraform plan -var="deploy_phase=base" -var="branch_name=${{ needs.infrastructure-base.outputs.branch_name }}" -var="gcp_project_id=${{ secrets.PROJECT_ID }}"
          echo "âœ… åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©Planå®Œäº† - Terraform Cloud UIã§Applyç¢ºèªãƒ»å®Ÿè¡Œã—ã¦ãã ã•ã„"
          echo ""
          echo "ğŸ“¦ ä½œæˆã•ã‚Œã‚‹ãƒªã‚½ãƒ¼ã‚¹:"
          echo "- Artifact Registry ãƒªãƒã‚¸ãƒˆãƒª (${{ env.ARTIFACT_REPO_BASE }})"
          echo "- Secret Manager ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆåŸºç›¤ãƒ•ã‚§ãƒ¼ã‚ºï¼‰"
          echo ""
          echo "ğŸ“‹ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:"
          echo "1. Terraform Cloud UI: https://app.terraform.io/app/${{ env.TF_CLOUD_ORGANIZATION }}/workspaces/${{ needs.infrastructure-base.outputs.workspace_name }}"
          echo "2. æœ€æ–°Runã®è©³ç´°ã‚’ç¢ºèª"
          echo "3. Auto-applyç„¡åŠ¹ã®å ´åˆã¯æ‰‹å‹•ã§Applyãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯"

  # Phase 2: Docker Build & Push
  docker-build:
    needs: [infrastructure-base]
    runs-on: ubuntu-latest
    if: vars.ENABLE_INTEGRATED_DEPLOY == 'true' && (needs.infrastructure-base.result == 'success')
    outputs:
      app_name: ${{ steps.env.outputs.app_name }}
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Set Environment Variables
        id: env
        run: |
          # ç’°å¢ƒåˆ¤å®š
          ENVIRONMENT=$([ "${{ github.ref }}" = "refs/heads/main" ] && echo "production" || echo "staging")
          
          # ENVä½¿ã£ã¦å„ç¨®åç§°ç”Ÿæˆ
          APP_NAME="${{ env.APP_NAME_BASE }}-$ENVIRONMENT"
          
          # GitHub Outputã«è¨­å®š
          echo "app_name=$APP_NAME" >> $GITHUB_OUTPUT
          
          echo "=== Phase 2: Docker Build ==="
          echo "Environment: $ENVIRONMENT"
          echo "App Name: $APP_NAME"
      
      - name: Authenticate to Google Cloud
        uses: google-github-actions/auth@v2
        with:
          credentials_json: ${{ secrets.GCLOUD_SERVICE_KEY }}
          project_id: ${{ secrets.PROJECT_ID }}
      
      - name: Setup Google Cloud SDK
        uses: google-github-actions/setup-gcloud@v2
      
      - name: Check Base Infrastructure Prerequisites
        run: |
          echo "ğŸ” åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œä¸­..."
          
          # Artifact Registryãƒªãƒã‚¸ãƒˆãƒªã®å­˜åœ¨ç¢ºèª
          if gcloud artifacts repositories describe ${{ env.ARTIFACT_REPO_BASE }} \
               --location=${{ env.REGION }} \
               --project=${{ secrets.PROJECT_ID }} >/dev/null 2>&1; then
            echo "âœ… Artifact Registry ãƒªãƒã‚¸ãƒˆãƒª (${{ env.ARTIFACT_REPO_BASE }}) ç¢ºèªæ¸ˆã¿"
          else
            echo "âŒ Artifact Registry ãƒªãƒã‚¸ãƒˆãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
            echo "ğŸ“‹ å¿…è¦ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³: Terraform Cloud UIã§åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©ã®Applyã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"
            exit 1
          fi
          
          echo "ğŸ‰ ã™ã¹ã¦ã®å‰ææ¡ä»¶ãŒæº€ãŸã•ã‚Œã¦ã„ã¾ã™"
      
      - name: Configure Docker for Artifact Registry
        run: |
          echo "ğŸ”§ Dockerèªè¨¼è¨­å®šä¸­..."
          gcloud auth configure-docker ${{ env.REGION }}-docker.pkg.dev --quiet
          echo "âœ… Dockerèªè¨¼è¨­å®šå®Œäº†"
      
      - name: Build and Push Docker Image
        env:
          APP_NAME: ${{ steps.env.outputs.app_name }}
        run: |
          echo "ğŸ³ Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰é–‹å§‹"
          IMAGE_SHA="${{ env.REGION }}-docker.pkg.dev/${{ secrets.PROJECT_ID }}/${{ env.ARTIFACT_REPO_BASE }}/${{ env.APP_NAME }}:${{ github.sha }}"
          IMAGE_LATEST="${{ env.REGION }}-docker.pkg.dev/${{ secrets.PROJECT_ID }}/${{ env.ARTIFACT_REPO_BASE }}/${{ env.APP_NAME }}:latest"
          
          echo "ğŸ“¦ ãƒ“ãƒ«ãƒ‰å¯¾è±¡ã‚¤ãƒ¡ãƒ¼ã‚¸:"
          echo "  SHA tag: $IMAGE_SHA"
          echo "  Latest tag: $IMAGE_LATEST"
          
          # Build and push with retry
          RETRY_COUNT=0
          MAX_RETRIES=3
          
          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do
            if gcloud builds submit --tag "$IMAGE_SHA" --quiet; then
              echo "âœ… Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰æˆåŠŸ: $IMAGE_SHA"
              break
            else
              RETRY_COUNT=$((RETRY_COUNT + 1))
              echo "âš ï¸ ãƒ“ãƒ«ãƒ‰å¤±æ•— (è©¦è¡Œ $RETRY_COUNT/$MAX_RETRIES)"
              if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then
                echo "ğŸ”„ 30ç§’å¾Œã«ãƒªãƒˆãƒ©ã‚¤ã—ã¾ã™..."
                sleep 30
              else
                echo "âŒ æœ€å¤§ãƒªãƒˆãƒ©ã‚¤å›æ•°ã«é”ã—ã¾ã—ãŸã€‚å¤±æ•—"
                exit 1
              fi
            fi
          done
          
          # Tag as latest
          gcloud container images add-tag "$IMAGE_SHA" "$IMAGE_LATEST" --quiet
          echo "âœ… latest ã‚¿ã‚°ä½œæˆå®Œäº†: $IMAGE_LATEST"

  # Phase 3: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ—ãƒ­ã‚¤
  application-deploy:
    needs: [infrastructure-base, docker-build]
    runs-on: ubuntu-latest
    if: vars.ENABLE_INTEGRATED_DEPLOY == 'true' && (github.ref != 'refs/heads/main' || vars.ENABLE_PRODUCTION_DEPLOY == 'true')
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Authenticate to Google Cloud
        uses: google-github-actions/auth@v2
        with:
          credentials_json: ${{ secrets.GCLOUD_SERVICE_KEY }}
          project_id: ${{ secrets.PROJECT_ID }}
      
      - name: Setup Google Cloud SDK
        uses: google-github-actions/setup-gcloud@v2
      
      - name: Check Application Prerequisites
        env:
          APP_NAME: ${{ needs.docker-build.outputs.app_name }}
        run: |
          echo "ğŸ” ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ—ãƒ­ã‚¤å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œä¸­..."
          echo "=== Phase 3: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ—ãƒ­ã‚¤ ==="
          
          # Artifact Registryãƒªãƒã‚¸ãƒˆãƒªã®å­˜åœ¨ç¢ºèª
          if gcloud artifacts repositories describe fact-checker-repo \
               --location=${{ env.REGION }} \
               --project=${{ secrets.PROJECT_ID }} >/dev/null 2>&1; then
            echo "âœ… Artifact Registry ãƒªãƒã‚¸ãƒˆãƒª (fact-checker-repo) ç¢ºèªæ¸ˆã¿"
          else
            echo "âŒ Artifact Registry ãƒªãƒã‚¸ãƒˆãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
            exit 1
          fi
          
          # Docker imageã®å­˜åœ¨ç¢ºèª
          IMAGE_URL="${{ env.REGION }}-docker.pkg.dev/${{ secrets.PROJECT_ID }}/${{ env.ARTIFACT_REPO_BASE }}/${APP_NAME}:latest"
          if gcloud container images describe "$IMAGE_URL" >/dev/null 2>&1; then
            echo "âœ… Docker image ç¢ºèªæ¸ˆã¿: $IMAGE_URL"
          else
            echo "âŒ Docker image ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $IMAGE_URL"
            exit 1
          fi
          
          echo "ğŸ‰ ã™ã¹ã¦ã®å‰ææ¡ä»¶ãŒæº€ãŸã•ã‚Œã¦ã„ã¾ã™"
      
      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: 1.6.6
          cli_config_credentials_token: ${{ secrets.TF_API_TOKEN }}
      
      - name: Terraform Init (Application Deploy)
        working-directory: ./infrastructure
        env:
          TF_WORKSPACE: ${{ needs.infrastructure-base.outputs.workspace_name }}
        run: |
          echo "ğŸš€ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³TerraformåˆæœŸåŒ–ä¸­..."
          terraform init
          echo "âœ… ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³TerraformåˆæœŸåŒ–å®Œäº†"
      
      - name: Terraform Plan (triggers Terraform Cloud for App)
        working-directory: ./infrastructure
        env:
          TF_WORKSPACE: ${{ needs.infrastructure-base.outputs.workspace_name }}
        run: |
          echo "ğŸš€ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³Terraform Planå®Ÿè¡Œã§Terraform Cloudï¼ˆãƒªãƒ¢ãƒ¼ãƒˆï¼‰ã‚’ãƒˆãƒªã‚¬ãƒ¼"
          terraform plan -var="deploy_phase=app" -var="branch_name=${{ needs.infrastructure-base.outputs.branch_name }}" -var="gcp_project_id=${{ secrets.PROJECT_ID }}"
          echo "âœ… ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³Planå®Œäº† - Terraform Cloud UIã§Applyç¢ºèªãƒ»å®Ÿè¡Œã—ã¦ãã ã•ã„"
          echo ""
          echo "ğŸ“¦ ä½œæˆã•ã‚Œã‚‹ãƒªã‚½ãƒ¼ã‚¹:"
          echo "- Cloud Run ã‚µãƒ¼ãƒ“ã‚¹ (${{ needs.docker-build.outputs.app_name }})"
          echo "- IAM ãƒ­ãƒ¼ãƒ«ãƒ»ãƒãƒªã‚·ãƒ¼ï¼ˆSecret ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ï¼‰"
          echo "- Cloud Scheduler ã‚¸ãƒ§ãƒ–"
          echo ""
          echo "ğŸ“‹ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:"
          echo "1. Terraform Cloud UI: https://app.terraform.io/app/${{ env.TF_CLOUD_ORGANIZATION }}/workspaces/${{ needs.infrastructure-base.outputs.workspace_name }}"
          echo "2. æœ€æ–°Runã®è©³ç´°ã‚’ç¢ºèª"
          echo "3. Auto-applyç„¡åŠ¹ã®å ´åˆã¯æ‰‹å‹•ã§Applyãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯"

  # çµ±åˆãƒ¬ãƒãƒ¼ãƒˆ
  deployment-report:
    needs: [infrastructure-base, infrastructure-apply, docker-build, application-deploy]
    runs-on: ubuntu-latest
    if: always()
    
    steps:
      - name: Integrated Deployment Status Report
        run: |
          echo "=== ğŸš€ çµ±åˆãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ ==="
          echo "å®Ÿè¡Œæ—¥æ™‚: $(date '+%Y-%m-%d %H:%M:%S')"
          echo ""
          
          echo "=== ğŸ“Š å„ãƒ•ã‚§ãƒ¼ã‚ºå®Ÿè¡Œçµæœ ==="
          echo "Phase 1 (åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©æ¤œè¨¼): ${{ needs.infrastructure-base.result }}"
          echo "Phase 1 (åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©é©ç”¨): ${{ needs.infrastructure-apply.result }}"
          echo "Phase 2 (Docker Build): ${{ needs.docker-build.result }}"
          echo "Phase 3 (ã‚¢ãƒ—ãƒªãƒ‡ãƒ—ãƒ­ã‚¤): ${{ needs.application-deploy.result }}"
          echo ""
          
          echo "=== ğŸ”§ å®‰å…¨å¼è¨­å®šçŠ¶æ³ ==="
          echo "ENABLE_INTEGRATED_DEPLOY: ${{ vars.ENABLE_INTEGRATED_DEPLOY }}"
          echo "ENABLE_PRODUCTION_DEPLOY: ${{ vars.ENABLE_PRODUCTION_DEPLOY }}"
          echo ""
          
          # æˆåŠŸåˆ¤å®š
          if [[ "${{ needs.infrastructure-base.result }}" == "success" && 
                "${{ needs.infrastructure-apply.result }}" == "success" && 
                "${{ needs.docker-build.result }}" == "success" && 
                "${{ needs.application-deploy.result }}" == "success" ]]; then
            echo "ğŸ‰ å…¨ãƒ•ã‚§ãƒ¼ã‚ºæˆåŠŸï¼ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆå®Œäº†"
          else
            echo "âš ï¸ ä¸€éƒ¨ãƒ•ã‚§ãƒ¼ã‚ºã§å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ"
            echo ""
            echo "ğŸ“‹ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:"
            if [[ "${{ vars.ENABLE_INTEGRATED_DEPLOY }}" != "true" ]]; then
              echo "1. ENABLE_INTEGRATED_DEPLOY=true ã‚’è¨­å®šã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’æœ‰åŠ¹åŒ–"
            fi
            if [[ "${{ github.ref }}" == "refs/heads/main" && "${{ vars.ENABLE_PRODUCTION_DEPLOY }}" != "true" ]]; then
              echo "2. ENABLE_PRODUCTION_DEPLOY=true ã‚’è¨­å®šã—ã¦æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã‚’æœ‰åŠ¹åŒ–"
            fi
            echo "3. å¤±æ•—ã—ãŸãƒ•ã‚§ãƒ¼ã‚ºã®ãƒ­ã‚°ã‚’ç¢ºèª"
            echo "4. Terraform Cloud UIã§ApplyçŠ¶æ³ã‚’ç¢ºèª"
          fi
          
          echo ""
          echo "=== ğŸ”— æœ‰ç”¨ãªãƒªãƒ³ã‚¯ ==="
          echo "- Terraform Cloud: https://app.terraform.io/app/${{ env.TF_CLOUD_ORGANIZATION }}/workspaces/${{ needs.infrastructure-base.outputs.workspace_name }}"
          echo "- GitHub Actions: https://github.com/${{ github.repository }}/actions"
